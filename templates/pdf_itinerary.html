<!-- PDF Itinerary Template -->
<div class="content-page">
    <h2 class="section-title">Itinerary</h2>

    <!-- Origin -->
    <div class="itinerary-item">
        <div class="point-header">
            <div class="point-number" style="background: #E74C3C;">ğŸš‰</div>
            <div>
                <div class="point-name-cn">Origin: {{ session.station.name }}</div>
                {% if session.station.city %}
                <div class="point-name-jp">{{ session.station.city }}, {{ session.station.prefecture }}</div>
                {% endif %}
            </div>
        </div>
        <p style="color: #7F8C8D; font-size: 13px;">
            ğŸ“ {{ session.station.coordinates.latitude }}, {{ session.station.coordinates.longitude }}
        </p>
    </div>

    <!-- Points -->
    {% for segment in session.route.segments %}
    <div class="itinerary-item">
        <div class="point-header">
            <div class="point-number">{{ segment.order }}</div>
            <div style="flex: 1;">
                <div class="point-name-cn">{{ segment.point.cn_name }}</div>
                <div class="point-name-jp">{{ segment.point.name }}</div>
            </div>
        </div>

        <!-- Bangumi Info -->
        <div class="bangumi-info">
            <span style="font-size: 20px;">ğŸ¬</span>
            <div>
                <div class="bangumi-title">{{ segment.point.bangumi_title }}</div>
                <div class="bangumi-episode">
                    Episode {{ segment.point.episode }} {{ segment.point.time_formatted }}
                </div>
            </div>
        </div>

        <!-- Transport Info -->
        {% if segment.transport %}
        <div class="transport-info">
            <span class="transport-icon">
                {% if segment.transport.mode == 'walking' %}
                ğŸš¶
                {% elif segment.transport.mode == 'transit' %}
                ğŸš‡
                {% else %}
                ğŸš—
                {% endif %}
            </span>
            <div style="flex: 1;">
                <div class="transport-mode">{{ segment.transport.mode }}</div>
                <div class="transport-details">
                    {{ segment.transport.distance_meters }}m â€¢
                    {{ segment.transport.duration_minutes }} min â€¢
                    {{ segment.transport.instructions }}
                </div>
                {% if segment.transport.transit_details %}
                <div class="transport-details" style="margin-top: 4px;">
                    {% for line in segment.transport.transit_details.get('lines', []) %}
                    <span class="badge">{{ line.name }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Cumulative Stats -->
        <div class="cumulative-info">
            <strong>Cumulative:</strong>
            {{ "%.1f"|format(segment.cumulative_distance_km) }} km â€¢
            {{ segment.cumulative_duration_minutes }} min
        </div>

        <!-- Screenshot -->
        {% if segment.point.screenshot_url %}
        <div style="margin-top: 12px; text-align: center;">
            <img src="{{ segment.point.screenshot_url }}"
                 alt="{{ segment.point.cn_name }}"
                 class="point-screenshot"
                 onerror="this.style.display='none'">
        </div>
        {% endif %}
    </div>
    {% endfor %}

    <!-- Summary -->
    <div style="margin-top: 30px; padding: 20px; background: #F0F4F8; border-radius: 8px;">
        <h3 style="margin-bottom: 12px; color: #667eea;">Summary</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
                <strong>Total points:</strong> {{ session.route.segments|length }}
            </div>
            <div>
                <strong>Total distance:</strong> {{ "%.1f"|format(session.route.total_distance_km) }} km
            </div>
            <div>
                <strong>Total time:</strong> {{ session.route.total_duration_formatted }}
            </div>
            <div>
                <strong>Anime works:</strong> {{ session.nearby_bangumi|length }}
            </div>
        </div>
    </div>
</div>

<div class="page-break"></div>
